import{g as r,aa as F,h,E as ue,x as O,af as Be,Y as je,l,M as g,j as ce,ag as Ke,z as $e,d as Ue,a1 as Me,ah as Ye,O as Y,a6 as Ze,a9 as Je,o as b,c as S,n as E,r as A,e as m,k as V,b as _,L as ie,F as We,t as re}from"./framework.060401c9.js";import{w as C,j as Ge,k as Xe,m as He,i as qe,b as Z,e as Qe}from"./dom.288056a2.js";import{I as es,a as ss,b as as}from"./index.46eab4e7.js";import{F as R}from"./index.34852432.js";import{a as de,b as ts,F as os,c as ns,d as pe,u as ve,e as j,f as H}from"./use-namespace.812d5fba.js";import{b as ls}from"./index.b1089a6f.js";const J="update:modelValue",W="change",G="input",is="blur",rs="focus",Vs={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},us=["class","style"],cs=/^on[A-Z]/,ds=(t={})=>{const{excludeListeners:o=!1,excludeKeys:i}=t,u=r(()=>((i==null?void 0:i.value)||[]).concat(us)),a=F();return a?r(()=>{var e;return Ge(Object.entries((e=a.proxy)==null?void 0:e.$attrs).filter(([n])=>!u.value.includes(n)&&!(o&&cs.test(n))))}):(C("use-attrs","getCurrentInstance() returned null. useAttrs() must be called at the top of a setup function"),r(()=>({})))};function ps(t){const o=h();function i(){if(t.value==null)return;const{selectionStart:a,selectionEnd:e,value:n}=t.value;if(a==null||e==null)return;const c=n.slice(0,Math.max(0,a)),d=n.slice(Math.max(0,e));o.value={selectionStart:a,selectionEnd:e,value:n,beforeTxt:c,afterTxt:d}}function u(){if(t.value==null||o.value==null)return;const{value:a}=t.value,{beforeTxt:e,afterTxt:n,selectionStart:c}=o.value;if(e==null||n==null||c==null)return;let d=a.length;if(a.endsWith(n))d=a.length-n.length;else if(a.startsWith(e))d=e.length;else{const f=e[c-1],I=a.indexOf(f,c-1);I!==-1&&(d=I+1)}t.value.setSelectionRange(d,d)}return[i,u]}function vs(t,{afterFocus:o,beforeBlur:i,afterBlur:u}={}){const a=F(),{emit:e}=a,n=ue(),c=h(!1),d=p=>{c.value||(c.value=!0,e("focus",p),o==null||o())},f=p=>{var N;Xe(i)&&i(p)||p.relatedTarget&&((N=n.value)!=null&&N.contains(p.relatedTarget))||(c.value=!1,e("blur",p),u==null||u())},I=()=>{var p;(p=t.value)==null||p.focus()};return O(n,p=>{p&&p.setAttribute("tabindex","-1")}),Be(n,"click",I),{wrapperRef:n,isFocused:c,handleFocus:d,handleBlur:f}}const B=h();function fe(t,o=void 0){const i=F()?g(de,B):B;return t?r(()=>{var u;return((u=i.value)==null?void 0:u[t])??o}):i}const _s=(t,o,i=!1)=>{const u=!!F(),a=u?fe():void 0,e=(o==null?void 0:o.provide)??(u?je:void 0);if(!e){C("provideGlobalConfig","provideGlobalConfig() can only be used inside setup().");return}const n=r(()=>{const c=l(t);return a!=null&&a.value?He(a.value,c):c});return e(de,n),e(ts,r(()=>n.value.locale)),e(os,r(()=>n.value.zIndex)),e(ns,r(()=>n.value.theme)),e(pe,{size:r(()=>n.value.size||"")}),(i||!B.value)&&(B.value=n.value),n},X={prefix:Math.floor(Math.random()*1e4),current:0},fs=Symbol("fzIdInjection"),ys=()=>F()?g(fs,X):X,Es=t=>{const o=ys();!qe&&o===X&&C("IdInjection",`Looks like you are using server rendering, you must provide a id provider to ensure the hydration process to be succeed
usage: app.provide(ID_INJECTION_KEY, {
  prefix: number,
  current: number,
})`);const i=ve("id");return r(()=>l(t)||`${i.b()}-${o.prefix}-${o.current++}`)},q=t=>{var u;const i=(u=F().proxy)==null?void 0:u.$props;return r(()=>i[t]??void 0)},Rs=(t,o={})=>{const i=h(void 0),u=o.prop?i:q("size"),a=o.global?i:fe("size"),e=o.form?{size:void 0}:g(j,void 0),n=o.formItem?{size:void 0}:g(H,void 0);return r(()=>u.value||l(t)||(n==null?void 0:n.size)||(e==null?void 0:e.size)||a.value||"default")},bs=()=>{const t=g(pe,{});return r(()=>l(t.size)||"")},ye=(t,o={})=>{const i=h(void 0),u=o.prop?i:q("size"),a=o.global?i:bs(),e=o.form?{size:void 0}:g(j,void 0),n=o.formItem?{size:void 0}:g(H,void 0);return r(()=>u.value||l(t)||(n==null?void 0:n.size)||(e==null?void 0:e.size)||a.value||"")},Ee=t=>{const o=q("disabled"),i=g(j,void 0);return r(()=>o.value||l(t)||(i==null?void 0:i.disabled)||!1)},Os=ye,Ds=Ee,ms=()=>{const t=g(j,void 0),o=g(H,void 0);return{form:t,formItem:o}},hs=(t,{formItemContext:o,disableIdGeneration:i,disableIdManagement:u})=>{i||(i=h(!1)),u||(u=h(!1));const a=h();let e;const n=r(()=>{var c;return!!(!t.label&&o&&o.inputIds&&((c=o.inputIds)==null?void 0:c.length)<=1)});return ce(()=>{e=O([Ke(t,"id"),i],([c,d])=>{const f=c??(d?void 0:Es().value);f!==a.value&&(o!=null&&o.removeInputId&&(a.value&&o.removeInputId(a.value),!(u!=null&&u.value)&&!d&&f&&o.addInputId(f)),a.value=f)},{immediate:!0})}),$e(()=>{e&&e(),o!=null&&o.removeInputId&&a.value&&o.removeInputId(a.value)}),{isLabeledByFormItem:n,inputId:a}},gs={id:{type:String,default:void 0},size:{type:String,default:"default"},disabled:Boolean,modelValue:{type:[String,Number,Object],default:""},type:{type:String,default:"text"},resize:{type:String},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Object},prefixIcon:{type:Object},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:[Object,Array,String],default:()=>({})},autofocus:{type:Boolean,default:!1}},Is={[J]:t=>Z(t),[G]:t=>Z(t),[W]:t=>Z(t),[rs]:t=>t instanceof FocusEvent,[is]:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},ws=["role"],Ss=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],Cs=Ue({name:"FzInput",inheritAttrs:!1,__name:"input",props:gs,emits:Is,setup(t,{expose:o,emit:i}){const u={},a=ve("input"),e=t,n=i,c=Me(),d=Ye(),f=ue(),I=h(!1),p=h(!1),z=h(!1),N=r(()=>{const s={};return e.containerRole==="combobox"&&(s["aria-haspopup"]=d["aria-haspopup"],s["aria-owns"]=d["aria-owns"],s["aria-expanded"]=d["aria-expanded"]),s}),be=r(()=>[a.b(),a.m(ge.value),a.is("disabled",T.value),a.is("exceed",Fe.value),{[a.b("group")]:c.prepend||c.append,[a.bm("group","append")]:c.append,[a.bm("group","prepend")]:c.prepend,[a.m("prefix")]:c.prefix||e.prefixIcon,[a.m("suffix")]:c.suffix||e.suffixIcon||e.clearable||e.showPassword,[a.bm("suffix","password-clear")]:L.value&&U.value},d.class]),me=r(()=>[a.e("wrapper"),a.is("focus",$.value)]),D=ds({excludeKeys:r(()=>Object.keys(N.value))}),{form:K,formItem:y}=ms(),{inputId:he}=hs(e,{formItemContext:y}),ge=ye(),T=Ee(),Ie=r(()=>e.showPassword?z.value?"text":"password":e.type),{wrapperRef:we,isFocused:$,handleFocus:Q,handleBlur:ee}=vs(f,{afterBlur(){var s;e.validateEvent&&((s=y==null?void 0:y.validate)==null||s.call(y,"blur").catch(v=>C(a.b(),v)))}}),se=r(()=>(K==null?void 0:K.statusIcon)??!1),k=r(()=>(y==null?void 0:y.validateState)||""),ae=r(()=>k.value&&u[k.value]),Se=r(()=>z.value?es:ss),Ce=r(()=>[d.style,e.inputStyle]),w=r(()=>Qe(e.modelValue)?"":String(e.modelValue)),L=r(()=>e.clearable&&!T.value&&!e.readonly&&!!w.value&&($.value||I.value)),U=r(()=>e.showPassword&&!T.value&&!e.readonly&&!!w.value&&(!!w.value||$.value)),P=r(()=>e.showWordLimit&&!!D.value.maxlength&&e.type==="text"&&!T.value&&!e.readonly&&!e.showPassword),te=r(()=>w.value.length),Fe=r(()=>!!P.value&&te.value>Number(D.value.maxlength)),ze=r(()=>!!c.suffix||!!e.suffixIcon||L.value||e.showPassword||P.value||!!k.value&&se.value),[Ne,Te]=ps(f),x=()=>{const s=f.value,v=e.formatter?e.formatter(w.value):w.value;!s||s.value===v||(s.value=v)},oe=async s=>{Ne();let{value:v}=s.target;if(e.formatter&&(v=e.parser?e.parser(v):v),!p.value){if(v===w.value){x();return}n(J,v),n(G,v),await Y(),x(),Te()}},ke=s=>{n(W,s.target.value)},xe=s=>{n("compositionstart",s),p.value=!0},Ve=s=>{n("compositionupdate",s),p.value=!0},_e=s=>{n("compositionend",s),p.value&&(p.value=!1,oe(s))},Re=()=>{z.value=!z.value,ne()},ne=async()=>{var s;await Y(),(s=f.value)==null||s.focus()},Oe=()=>{var s;return(s=f.value)==null?void 0:s.blur()},De=s=>{I.value=!1,n("mouseleave",s)},Le=s=>{I.value=!0,n("mouseenter",s)},Pe=s=>{n("keydown",s)},Ae=()=>{var s;(s=f.value)==null||s.select()},le=s=>{s.preventDefault(),n(J,""),n(W,""),n(G,""),n("clear")};return O(()=>e.modelValue,()=>{var s;e.validateEvent&&((s=y==null?void 0:y.validate)==null||s.call(y,"change").catch(v=>C(a.b(),v)))}),O(w,()=>x()),O(()=>e.type,async()=>{await Y(),x()}),ce(()=>{!e.formatter&&e.parser&&C("FzInput","If you set the parser, you also need to set the formatter."),x()}),o({input:f,focus:ne,blur:Oe,select:Ae,clear:le}),(s,v)=>Ze((b(),S("div",ie(N.value,{class:be.value,style:Ce.value,role:s.containerRole,onMouseenter:Le,onMouseleave:De}),[s.$slots.prepend?(b(),S("div",{key:0,class:E(l(a).be("group","prepend"))},[A(s.$slots,"prepend")],2)):m("",!0),V("div",{ref_key:"wrapperRef",ref:we,class:E(me.value)},[s.$slots.prefix||s.prefixIcon?(b(),S("span",{key:0,class:E(l(a).e("prefix"))},[V("span",{class:E(l(a).e("prefix-inner"))},[A(s.$slots,"prefix"),s.prefixIcon?(b(),_(l(R),{key:0,icon:s.prefixIcon,class:E(l(a).e("icon"))},null,8,["icon","class"])):m("",!0)],2)],2)):m("",!0),V("input",ie({id:l(he),ref_key:"input",ref:f,class:l(a).e("inner")},l(D),{type:Ie.value,disabled:l(T),formatter:s.formatter,parser:s.parser,readonly:s.readonly,autocomplete:s.autocomplete,tabindex:s.tabindex,"aria-label":s.label,placeholder:s.placeholder,style:s.inputStyle,form:e.form,autofocus:s.autofocus,onCompositionstart:xe,onCompositionupdate:Ve,onCompositionend:_e,onInput:oe,onFocus:v[0]||(v[0]=(...M)=>l(Q)&&l(Q)(...M)),onBlur:v[1]||(v[1]=(...M)=>l(ee)&&l(ee)(...M)),onChange:ke,onKeydown:Pe}),null,16,Ss),ze.value?(b(),S("span",{key:1,class:E(l(a).e("suffix"))},[V("span",{class:E(l(a).e("suffix-inner"))},[!L.value||!U.value||!P.value?(b(),S(We,{key:0},[A(s.$slots,"suffix"),s.suffixIcon?(b(),_(l(R),{key:0,icon:s.suffixIcon,class:E(l(a).e("icon"))},null,8,["icon","class"])):m("",!0)],64)):m("",!0),L.value?(b(),_(l(R),{key:1,class:E([l(a).e("icon"),l(a).e("clear")]),icon:l(as),onClick:le},null,8,["class","icon"])):m("",!0),U.value?(b(),_(l(R),{key:2,class:E([l(a).e("icon"),l(a).e("password")]),icon:Se.value,onClick:Re},null,8,["class","icon"])):m("",!0),P.value?(b(),S("span",{key:3,class:E(l(a).e("count"))},[V("span",{class:E(l(a).e("count-inner"))},re(te.value)+" / "+re(l(D).maxlength),3)],2)):m("",!0),k.value&&ae.value&&se.value?(b(),_(l(R),{key:4,class:E([l(a).e("icon"),l(a).e("validateIcon"),l(a).is("loading",k.value==="validating")]),icon:ae.value},null,8,["class","icon"])):m("",!0)],2)],2)):m("",!0)],2),s.$slots.append?(b(),S("div",{key:1,class:E(l(a).be("group","append"))},[A(s.$slots,"append")],2)):m("",!0)],16,ws)),[[Je,s.type!=="hidden"]])}}),Ls=ls(Cs);export{is as B,W as C,Vs as E,Ls as F,G as I,J as U,ys as a,Rs as b,ms as c,ye as d,hs as e,Ee as f,rs as g,vs as h,ps as i,ds as j,Es as k,Ds as l,Os as m,_s as p,fe as u};
